<!--
 * @Author: yuzihan yuzihanyuzihan@163.com
 * @Date: 2022-05-19 13:11:16
 * @LastEditors: yuzihan yuzihanyuzihan@163.com
 * @LastEditTime: 2022-05-20 15:41:17
 * @FilePath: /fe_interview/服务器/网站搭建.md
 * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
-->
# 搭建个人wordpress网站
@[TOC](文章目录)

## 一、宝塔面板安装流程
阿里云主机新老特惠，阿里云主机[点击了解](https://www.aliyun.com/daily-act/ecs/activity_selection?userCode=iikoa47v)

宝塔服务器面板，一键全能部署及管理，送你3188元礼包，[点我领取](https://www.bt.cn/?invite_code=MV9nbmVqb28=)
1. ssh远程登录服务器
2. 执行宝塔面板安装命令(使用于cenos)
```
yum install -y wget && wget -O install.sh http://download.bt.cn/install/install_6.0.sh && sh install.sh
```
安装完成后会提示管理地址，如果无法访问就去给服务器设置开放8888端口：点安全组->配置规则->手动添加8888端口（其他列模仿旧的填）
输入bt命令可以看到更详细信息
3. 访问宝塔管理后台
账号密码登录->弹框推荐LNMP并选择编辑安装（比较稳定）

## 二、域名解析
1. 阿里云控制台->域名->解析->新手引导（属于域名解析设置的快捷方式，或者手动添加也可以）->网站解析填记录值(公网IP)

## 三、部署WordPress
1. 打开宝塔管理后台->软件商店->应用分类点一键部署->输入域名（比如：www.yuzihan.tech或者yuzihan.tech，二者访问时）->备份弹框中数据库账号信息和站点访问url
如果URL白屏无法访问，阿里云控制台->点安全组->配置规则->手动添加80端口（其他列模仿旧的填）
如果404，则需要排查一下之前是否安装过nginx，是否部署过其他站点，如果部署过其他站点，则需要卸载nginx，并在宝塔面板删除刚刚部署的站点yuzihan.tech和数据库，然后重新在软件商城重新部署nginx和重新一键部署wordpress
不带www域名配置方式：
打开宝塔管理后台->网站->设置->域名管理->输入yuzihan.tech新增
宝塔面板->配置->伪静态->选择站点->确定
使用WordPress建站，通常都是使用伪静态，这样有利于SEO

2. 配置wordpress
根据上一步”备份弹框中数据库账号信息和站点访问url”信息，访问该url，弹框选择简体中文->依次根据备份信息填入数据库名、用户名和用户密码，数据库主机和表前缀默认值不动->提交->执行安装程序->填站点标题、使用者名称、密码（可以使用默认密码需要备份一下，这里的名称和密码用于登录管理端）、邮箱，搜索引擎那块不要勾选->确定
打开主站，www.谷歌浏览器默认隐藏，如果主站打不开，强制刷新试试

3. 固定链接设置
wordpress管理端仪表盘->设置->固定链接->/%post_id%.html, 也就是伪静态的形式，有利于SEO

## 四、SSH秘钥对登录云服务器
1. 适用场景：适用于批量维护多台服务器实例的场景，个人维护的一台服务器可以用常规的用户名密码登录

2. 创建方式：阿里云ECS工作台->网络与安全->安全组->秘钥对->创建秘钥对->名称（比如test01）->创建类型选自动创建->资源组选默认->标签可选可不选->确定后会自动将私钥下载到本地（后缀.pem）->绑定秘钥对->弹框选择ECS实例点右移箭头进已选择列表->点确定（秘钥对就已经绑定到服务器上）->重启服务器实例生效

公钥阿里云保存，私钥我们自己可以下载

3. 在支持SSH命令的环境使用秘钥对登录
windows下可以下载安装支持SSH命令的MobaXterm
修改私钥文件属性：chmod 400 [.pem文件路径]->连接至实例:ssh -i [.pem文件路径] root@[公网IP地址]->可以看到连接成功的打印信息
文件路径可以直接拖动文件到命令行显示

## 五、ssl证书配置
1. 证书申请
阿里云控制面板搜索ssl->ssl证书->免费证书->可免费申请20个证书->创建证书(先创建一个)->下载（nginx版）->打开压缩包里文件，复制对应文件内容
打开宝塔面板->网站->配置->ssl->其他证书，粘贴上面对应文件内容->强制HTTPS打开->打开站点验证
配置完如果打不开，可能是443端口没打开，阿里云控制台去打开

## 六、故障排查
如果宝塔面板出现bug，可以通过卸载解决，比如点击设置伪静态命令报错
补充：卸载命令
```
/etc/init.d/bt stop && chkconfig --del bt && rm -f /etc/init.d/bt && rm -rf /www/server/panel
```