<!--
 * @Author: yuzihan yuzihanyuzihan@163.com
 * @Date: 2022-06-09 18:01:22
 * @LastEditors: yuzihan yuzihanyuzihan@163.com
 * @LastEditTime: 2022-06-09 22:26:34
 * @FilePath: /fe_interview/web3/区块链.md
 * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
-->
1. RPC功能全称为Remote Procedure Call，翻译成中文意思就是 “ 远程过程调用 ”， 目前，主流平台都支持各种远程调用技术，以满足分布式系统架构中不同的系统之间的远程通信和相互调用。
- rpc是什么？
A服务器应用调用B服务器上应用的方法，由于不在一个内存空间，不能直接调动，需要通过网络来表达调用的语义和传达调用的数据
- 为什么不用http?
RPC是完整的远程调用方案，包括通信协议和序列化协议；通信协议里包含http协议（如grpc使用http2）、自定义报文的tcp协议（如bubbo）,序列化协议包含基于文本编码的xml、json，基于二进制编码的protobuf、hessian等
- 为何有些后端子系统之间使用自定义tcp协议的rpc来做进程通信，而不是使用http协议？
http协议支持连接池复用，建立一定数量的连接不断开，并不会频繁的创建和销毁连接;http也可以使用protobuf这种二进制协议对内容进行编码，连接的建立与断开的开销和序列化协议并不是主要的影响因素，二者最大的区别还是在传输协议上；http传输协议的header有很多冗余部分，像Content-Type、Last-Modified、Expired等，即使http body使用二进制编码协议，header的键值对却用了文本编码，非常暂用字节数；而自定义的tcp协议，可以精简传输内容，传输效率更高。比如下面的自定义tcp协议的报文：1-4 byte, length 5-8byte, type, 9-16byte, package_id, 17-length+16 byte, package_data, 报头占用的字节数也就只有16个byte，大大减少了传输内容，高并发情况下，少几个字节，乘以庞大请求数，能带来庞大收益；因此，对于性能要求高的后端系统来说，通常使用自定义的tcp协议的rpc来做后端进程通信；使用http协议比较多的地方还是前后端的通信，原因在于主流网页浏览器都支持http协议，而且http在缓存、幂等重试乃至cookie这种浏览器安全相关的方面做了很多功夫

2. 区块链节点：是指区块链网络中的计算机，也就是说任何连接到区块链网络的计算机（包括手机和矿机等）都称为节点
- 节点特征：具有存储空间，可以将区块数据存储在TF卡、U盘、移动硬盘和计算机等；连接网络，所有存储空间的设备必须连接网络; 参与区块链，需要在存储空间上运行区块链响应程序，通过可视化终端进行交易；

3. 拜占庭将军问题
- 1982年兰伯特提出，几路军队进攻同一城堡的通信问题，超过一半投票在同一时间进攻，就进攻，比如7支军队，有一支叛徒，当三支投票进攻，三支投票撤退的时候，这个叛徒对投票进攻的部队说投票进攻，对投票撤退的部队说投票撤退，结果导致战斗失败
- 计算机分布式节点有可能故障、宕机或者恶意节点，如果保持一致性、正确性
- 解决方法：最开始口头协议和书面协议；口头协议，先简化成司令或者将军和副官模型，将军就是第一个提出应该进攻的人，忠诚的副官遵守同一个命令->一致性，若将军是忠诚的，忠诚的副官必须执行它的命令->正确性;m是恶意的个数，n是总的个数，n > 3m时是可解的，比如m是1，n是3，一个将军下命令给两个副官，一个副官是忠诚的，一个是叛徒，将军通知两个副官进攻，忠诚的副官并不知道将军是不是叛徒，所以去问叛徒副官收到的命令，叛徒副官告诉他撤退，忠诚副官将会很迷惑；另一种情况，将军是叛徒，告诉一个进攻另一个撤退，两个副官通信时又告诉对方不一样的命令，也会出问题；n=4, m=1的情况，1个忠诚将军，两忠诚副官，一个叛徒副官，将军发出进攻命令，两个忠诚副官最终收到两个进攻和一个撤退命令；将军叛徒，3个副官忠诚，还能达到目的吗，将军跟两个副官说进攻，跟一个说撤退，发现三个副官都是接到两个进攻和一个撤退，那三个就达成一致了；m=2, n=7时就需要递归，波兰特这个口头协议是没考虑网略延迟的情况，实际是有网络延迟的，这个算法是不能用的
- PBFT，99年有几个人提出更加简洁容错的拜占庭容错算法叫做PBFT,这种算法可以保证在又网络延迟的情况下，依然可以保证少数恶意节点和故障节点存在时，大部分忠诚节点的一致性和可读性；pow计算hash值就是增加叛徒的成本，安排做一个数学题，恶意节点想比其他所有忠诚节点做的都多，都快；pow算力证明被很多人诟病，因为它就是算一道毫无意义的数学题，浪费了电没有创造价值

3. nonce
Nonce 这个单词在密码学语境下指的是一个只使用一次的数字。比特币的 nonce 是用在 POW 共识算法之中的一个数字。
理解 nonce 的运算过程是理解 POW 共识算法的核心，本节的内容就是这些了，需要记住的是以下几点：第一，nonce 是每个区块 header 中保存的一个数。第二，一旦找到合适的 nonce 让 header 的哈希小于 target 就意味着成功得到了最终的 nonce 。第三，为了保证平均起来每次找到 nonce 的时间趋近十分钟，target 会每两周调整一次。
